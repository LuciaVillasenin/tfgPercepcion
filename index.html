<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuestionario de Discriminación Auditiva y Visual</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f4f4f4;
            color: #333;
        }

        h1,
        h2 {
            color: #0056b3;
            text-align: center;
        }

        fieldset {
            margin-bottom: 20px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fff;
        }

        legend {
            font-weight: bold;
            color: #0056b3;
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }

        button {
            margin: 5px;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #0056b3;
        }

        .linea-container {
            display: inline-block;
            height: 100px;
            width: 300px;
            margin: 0 10px 20px 0;
            position: relative;
            overflow: hidden;
        }

        .linea {
            display: inline-block;
            height: 2px;
            background-color: #000;
            position: absolute;
            top: 50%;
            left: 0;
            transform-origin: left center;
        }

        label {
            margin-right: 15px;
        }

        input[type="radio"] {
            margin-right: 5px;
        }

        .feedback {
            margin-top: 10px;
            color: green;
            font-weight: bold;
        }

        #cuestionario button[type="submit"] {
            display: block;
            margin: 20px auto;
            padding: 15px 30px;
            font-size: 1.2em;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #cuestionario button[type="submit"]:hover {
            background-color: #0056b3;
        }

        .lineas-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }
    </style>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h1>Cuestionario de Discriminación Auditiva y Visual</h1>

    <section>
        <h2>Bienvenido/a</h2>
        <p>
            Este cuestionario forma parte de mi Trabajo de Fin de Grado que consiste en un estudio sobre percepción
            auditiva y visual. El objetivo es evaluar tu capacidad para discriminar estímulos sonoros y visuales. Este
            cuestionario es totalmente anónimo.
        </p>
        <p>
            Para asegurar la validez de los resultados, es muy importante que realices este cuestionario COMPLETO una
            sola vez. Repetir el cuestionario o hacerlo de forma incompleta afectará negativamente a la calidad de los
            datos y, por lo tanto, a la validez de mi estudio. <strong>Se recomienda el uso de auriculares para su
                realización. Puedes reproducir los sonidos todas las veces que lo necesites.</strong>
        </p>
        <p>
            Por favor, responde a todas las preguntas con atención y honestidad. ¡Muchas gracias por tu ayuda!
        </p>
    </section>

    <form id="cuestionario" action="https://formspree.io/f/mnnpnvyb" method="POST">

        <fieldset>
            <legend>Información Demográfica</legend>

            <label for="edad">Edad:</label>
            <input type="number" id="edad" name="edad" min="18" max="100" required><br><br>

            <label for="genero">Género:</label>
            <select id="genero" name="genero" required>
                <option value="">Selecciona</option>
                <option value="masculino">Masculino</option>
                <option value="femenino">Femenino</option>
                <option value="otro">Otro</option>
            </select><br><br>

            <label for="estudios">Nivel de Estudios:</label>
            <select id="estudios" name="estudios" required>
                <option value="">Selecciona</option>
                <option value="sin_estudios">Sin Estudios</option>
                <option value="primaria">Primaria</option>
                <option value="secundaria">Secundaria</option>
                <option value="universitario">Universitario</option>
                <option value="postgrado">Postgrado</option>
            </select><br><br>

            <label for="conocimientos_musicales">¿Tienes conocimientos musicales?</label>
            <select id="conocimientos_musicales" name="conocimientos_musicales" required>
                <option value="">Selecciona</option>
                <option value="si">Sí</option>
                <option value="no">No</option>
            </select><br><br>
        </fieldset>

        <!-- Parte 1: Discriminación Auditiva -->
        <fieldset>
            <legend>Parte 1: Discriminación Auditiva</legend>
            <p>En cada prueba, escucha los sonidos A y B y selecciona cuál es más largo o si son iguales.</p>
            <div id="preguntas"></div>
        </fieldset>

        <!-- Parte 2: Discriminación de Secuencias -->
        <fieldset>
            <legend>Parte 2: Discriminación de Secuencias</legend>
            <p>Escucha cada secuencia de sonidos y selecciona cuál es más larga.</p>
            <div id="preguntasSecuencias"></div>
        </fieldset>

        <!-- Parte 3: Discriminación Visual de la Línea Más Larga -->
        <fieldset>
            <legend>Parte 3: Discriminación Visual de la Línea Más Larga</legend>
            <p>Selecciona cuál de las líneas es la más larga o si son iguales.</p>
            <div id="preguntasLineas"></div>
        </fieldset>

        <!-- Parte 4: Discriminación de la Suma de Líneas Más Larga -->
        <fieldset>
            <legend>Parte 4: Discriminación de la Suma de Líneas Más Larga</legend>
            <p>Selecciona cuál es la suma de líneas más larga o si son iguales.</p>
            <div id="preguntasSumas"></div>
        </fieldset>

        <button type="submit">Enviar Respuestas</button>
    </form>

    <script>
        // Ofuscación básica del código JavaScript
        (function () {
            var _0x4c02 = ['4677854uYlXN', '1827516uQIZOX', '18mzlNJD', '23eQkRYG', '78936bYkFqg', '4255608mQAZsX',
                '1708844UfFhCt', '178917XKmUya', '3988862BWeXyJ', '1077100mGcLef'
            ];
            var _0x5f3c = function (_0x120234, _0x35f3c3) {
                _0x120234 = _0x120234 - 0x0;
                var _0x4c02b4 = _0x4c02[_0x120234];
                return _0x4c02b4;
            };
            (function (_0x26a637, _0x28c823) {
                var _0x52c63b = _0x5f3c;
                while (!![]) {
                    try {
                        var _0x39e62c = parseInt(_0x52c63b(0x3)) * (parseInt(_0x52c63b(0x1)) / 0x2) + -parseInt(
                            _0x52c63b(0x8)) + parseInt(_0x52c63b(0x6)) + -parseInt(_0x52c63b(0x2)) + parseInt(
                            _0x52c63b(0x7)) * (-parseInt(_0x52c63b(0x9)) / 0x3) + -parseInt(_0x52c63b(0x0)) +
                            parseInt(_0x52c63b(0x4)) * (-parseInt(_0x52c63b(0x5)) / 0x5);
                        if (_0x39e62c === _0x28c823) break;
                        else _0x26a637['push'](_0x26a637['shift']());
                    } catch (_0x4df42d) {
                        _0x26a637['push'](_0x26a637['shift']());
                    }
                }
            }(_0x4c02, 0xae109));
            // Parte 1: Pruebas de tonos
            const pruebasTonos = [{
                    A: 700,
                    B: 700
                },
                {
                    A: 500,
                    B: 525
                },
                {
                    A: 550,
                    B: 600
                },
                {
                    A: 600,
                    B: 625
                },
                {
                    A: 700,
                    B: 750
                },
                {
                    A: 450,
                    B: 500
                },
                {
                    A: 700,
                    B: 700
                },
                {
                    A: 500,
                    B: 550
                },
                {
                    A: 600,
                    B: 650
                },
                {
                    A: 550,
                    B: 575
                }
            ];

            // Parte 2: Pruebas de secuencias
            const pruebasSecuencias = [{
                    A: [400, 600, 500],
                    B: [350, 450, 400, 500]
                },
                {
                    A: [300, 500, 400, 600],
                    B: [250, 350, 450, 400, 500]
                },
                {
                    A: [700, 800, 750],
                    B: [500, 600, 700, 450]
                },
                {
                    A: [200, 300, 400, 500, 600],
                    B: [180, 280, 380, 480, 580, 680]
                },
                {
                    A: [450, 550, 600, 700],
                    B: [800, 850, 750]
                },
                {
                    A: [500, 600, 700],
                    B: [450, 550, 650, 600]
                },
                {
                    A: [300, 400, 500, 600, 700],
                    B: [250, 350, 450, 500, 650, 700]
                },
                {
                    A: [600, 700, 800, 900],
                    B: [550, 650, 750, 850, 950]
                },
                {
                    A: [400, 500, 600],
                    B: [350, 450, 500, 550]
                },
                {
                    A: [450, 550, 650, 750],
                    B: [600, 700, 800]
                }
            ];

            // Parte 3: Pruebas de la línea más larga
            const pruebasLineas = [{
                    A: 200,
                    B: 250
                },
                {
                    A: 150,
                    B: 150
                },
                {
                    A: 100,
                    B: 80
                },
                {
                    A: 220,
                    B: 180
                },
                {
                    A: 120,
                    B: 120
                },
                {
                    A: 180,
                    B: 200
                }, // Nueva prueba
                {
                    A: 250,
                    B: 220
                }, // Nueva prueba
                {
                    A: 90,
                    B: 110
                }, // Nueva prueba
                {
                    A: 160,
                    B: 160
                }, // Nueva prueba
                {
                    A: 210,
                    B: 190
                } // Nueva prueba
            ];

            // Parte 4: Pruebas de la suma de líneas más larga
            const pruebasSumas = [{
                    A: [50, 100],
                    B: [40, 80, 50]
                },
                {
                    A: [80, 120],
                    B: [70, 90, 60]
                },
                {
                    A: [100, 120, 80],
                    B: [50, 60, 90, 70]
                },
                {
                    A: [30, 50],
                    B: [60, 80, 40]
                },
                {
                    A: [70, 70, 70],
                    B: [50, 50, 50, 50]
                },
                {
                    A: [60, 90],
                    B: [50, 70, 30]
                }, // Nueva prueba
                {
                    A: [40, 60, 50],
                    B: [70, 30, 40]
                }, // Nueva prueba
                {
                    A: [80, 80],
                    B: [60, 50, 30]
                }, // Nueva prueba
                {
                    A: [50, 40, 30],
                    B: [60, 60]
                }, // Nueva prueba
                {
                    A: [90, 50],
                    B: [40, 40, 40]
                } // Nueva prueba
            ];

            let audioCtx = new(window.AudioContext || window.webkitAudioContext)();
            let playing = false; // Estado del audio
            let formSubmitted = false; // Control para evitar envíos múltiples

            function generarSonido(duracion) {
                if (playing) return; // Evita superposición

                playing = true;
                let osc = audioCtx.createOscillator();
                osc.frequency.setValueAtTime(440, audioCtx.currentTime);
                osc.type = "sine";
                osc.connect(audioCtx.destination);
                osc.start();

                setTimeout(() => {
                    osc.stop();
                    playing = false;
                }, duracion);
            }

            function generarSecuencia(tonos) {
                if (playing) return;

                playing = true;
                let startTime = audioCtx.currentTime;

                tonos.forEach((duracion, index) => {
                    let osc = audioCtx.createOscillator();
                    osc.frequency.setValueAtTime(440, startTime + index * (duracion / 1000));
                    osc.type = "sine";
                    osc.connect(audioCtx.destination);
                    osc.start(startTime + index * (duracion / 1000));
                    osc.stop(startTime + index * (duracion / 1000) + duracion / 1000);
                });

                setTimeout(() => {
                    playing = false;
                }, tonos.reduce((a, b) => a + b, 0));
            }

            // Crear preguntas de tonos
            function crearPregunta(index, tonoA, tonoB) {
                const div = document.createElement("fieldset");
                div.innerHTML = `
                <legend><strong>Prueba ${index + 1}</strong></legend>
                <button type="button" onclick="generarSonido(${tonoA})">Reproducir Sonido A</button>
                <button type="button" onclick="generarSonido(${tonoB})">Reproducir Sonido B</button>
                <br>
                <label><input type="radio" name="prueba${index}" value="A" required> A es más largo</label><br>
                <label><input type="radio" name="prueba${index}" value="B"> B es más largo</label><br>
                <label><input type="radio" name="prueba${index}" value="Iguales"> Son iguales</label>
                <div class="feedback" id="feedback${index}"></div>
            `;
                document.getElementById("preguntas").appendChild(div);
            }

            // Crear preguntas de secuencias
            function crearPreguntaSecuencia(index, secuenciaA, secuenciaB) {
                const div = document.createElement("fieldset");
                div.innerHTML = `
                <legend><strong>Prueba ${index + 1}</strong></legend>
                <button type="button" onclick="generarSecuencia([${secuenciaA}])">Reproducir Secuencia A</button>
                <button type="button" onclick="generarSecuencia([${secuenciaB}])">Reproducir Secuencia B</button>
                <br>
                <label><input type="radio" name="pruebaSecuencia${index}" value="A" required> A es más larga</label><br>
                <label><input type="radio" name="pruebaSecuencia${index}" value="B"> B es más larga</label><br>
                <label><input type="radio" name="pruebaSecuencia${index}" value="Iguales"> Son iguales</label>
                <div class="feedback" id="feedbackSecuencia${index}"></div>
            `;
                document.getElementById("preguntasSecuencias").appendChild(div);
            }

            // Crear preguntas de líneas más largas
            function crearPreguntaLinea(index, largoA, largoB) {
                const anguloA = Math.random() * 45 - 22.5;
                const anguloB = Math.random() * 45 - 22.5;

                const div = document.createElement("fieldset");
                div.innerHTML = `
                <legend><strong>Prueba ${index + 1}</strong></legend>
                <div class="lineas-container">
                  <div class="linea-container">
                      <div class="linea" style="width: ${largoA}px; transform: rotate(${anguloA}deg);"></div>
                      <span style="position: absolute; left: ${largoA + 5}px;">A</span>
                  </div>
                  <div class="linea-container">
                      <div class="linea" style="width: ${largoB}px; transform: rotate(${anguloB}deg);"></div>
                      <span style="position: absolute; left: ${largoB + 5}px;">B</span>
                  </div>
                </div>
                <br>
                <label><input type="radio" name="pruebaLinea${index}" value="A" required> A es más larga</label><br>
                <label><input type="radio" name="pruebaLinea${index}" value="B"> B es más larga</label><br>
                <label><input type="radio" name="pruebaLinea${index}" value="Iguales"> Son iguales</label>
                <div class="feedback" id="feedbackLinea${index}"></div>
            `;
                document.getElementById("preguntasLineas").appendChild(div);
            }

            // Crear preguntas de la suma de líneas más largas
            function crearPreguntaSuma(index, sumA, sumB) {
                const anguloA = Math.random() * 45 - 22.5;
                const anguloB = Math.random() * 45 - 22.5;

                const div = document.createElement("fieldset");
                div.innerHTML = `
                <legend><strong>Prueba ${index + 1}</strong></legend>
                <div class="lineas-container">
                  <div class="linea-container">
                      ${sumA.map((largo, i) =>
                    `<div class="linea" style="width: ${largo}px; transform: rotate(${anguloA}deg) translateY(${i * 10}px);"></div>`
                ).join("")}
                      <span style="position: absolute; left: ${Math.max(...sumA) + 5}px;">A</span>
                  </div>
                  <div class="linea-container">
                      ${sumB.map((largo, i) =>
                    `<div class="linea" style="width: ${largo}px; transform: rotate(${anguloB}deg) translateY(${i * 10}px);"></div>`
                ).join("")}
                      <span style="position: absolute; left: ${Math.max(...sumB) + 5}px;">B</span>
                  </div>
                </div>
                <br>
                <label><input type="radio" name="pruebaSuma${index}" value="A" required> A es más largo</label><br>
                <label><input type="radio" name="pruebaSuma${index}" value="B"> B es más largo</label><br>
                <label><input type="radio" name="pruebaSuma${index}" value="Iguales"> Son iguales</label>
                <div class="feedback" id="feedbackSuma${index}"></div>
            `;
                document.getElementById("preguntasSumas").appendChild(div);
            }

            // Generar todas las preguntas
            pruebasTonos.forEach((p, index) => crearPregunta(index, p.A, p.B));
            pruebasSecuencias.forEach((p, index) => crearPreguntaSecuencia(index, p.A, p.B));
            pruebasLineas.forEach((p, index) => crearPreguntaLinea(index, p.A, p.B));
            pruebasSumas.forEach((p, index) => crearPreguntaSuma(index, p.A, p.B));

            // Función para prevenir envíos múltiples
            document.getElementById("cuestionario").addEventListener("submit", function (event) {
                if (formSubmitted) {
                    event.preventDefault();
                    alert("Ya has enviado este formulario. Gracias por participar.");
                } else {
                    formSubmitted = true;
                }
            });
        })();
    </script>
    <script>
        const timestamp = new Date().getTime();
        const styleSheet = document.querySelector('link[rel="stylesheet"]');
        styleSheet.href = styleSheet.href + '?v=' + timestamp;
    </script>
    <script src="script.js"></script>
</body>

</html>
