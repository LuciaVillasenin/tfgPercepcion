<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuestionario de Discriminación Auditiva</title>
</head>
<body>
    <h1>Cuestionario de Discriminación Auditiva</h1>
    <p>Toca los botones para escuchar los sonidos y selecciona la respuesta correcta.</p>

    <form id="cuestionario" action="https://formspree.io/f/mnnpnvyb" method="POST">
        <div id="preguntas"></div>
        <button type="submit">Enviar Respuestas</button>
    </form>

    <script>
        // Crear el AudioContext fuera de la función para evitar restricciones en móviles
        let audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        const pruebas = [
            { A: 700, B: 700 },
            { A: 500, B: 525 },
            { A: 550, B: 600 },
            { A: 600, B: 625 },
            { A: 700, B: 750 },
            { A: 450, B: 500 },
            { A: 700, B: 700 },
            { A: 500, B: 550 },
            { A: 600, B: 650 },
            { A: 550, B: 575 }
        ];

        function generarSonido(duracion) {
            // Reactivar AudioContext si está suspendido (para móviles)
            if (audioCtx.state === "suspended") {
                audioCtx.resume();
            }

            const osc = audioCtx.createOscillator();
            osc.frequency.setValueAtTime(440, audioCtx.currentTime);
            osc.type = "sine";

            const gainNode = audioCtx.createGain();
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime); // Reduce volumen

            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            osc.start();
            setTimeout(() => osc.stop(), duracion);
        }

        function crearPregunta(index, tonoA, tonoB) {
            const div = document.createElement("div");
            div.innerHTML = `
                <h3>Prueba ${index + 1}</h3>
                <button type="button" onclick="generarSonido(${tonoA})">Reproducir Sonido A</button>
                <button type="button" onclick="generarSonido(${tonoB})">Reproducir Sonido B</button>
                <br>
                <label><input type="radio" name="prueba${index}" value="A"> A es más largo</label>
                <label><input type="radio" name="prueba${index}" value="B"> B es más largo</label>
                <label><input type="radio" name="prueba${index}" value="Iguales"> Son iguales</label>
                <br>
            `;
            document.getElementById("preguntas").appendChild(div);
        }

        pruebas.forEach((p, i) => crearPregunta(i, p.A, p.B));
    </script>
</body>
</html>
